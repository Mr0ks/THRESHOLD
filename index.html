<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Threshold - Investigation Simulation</title>
<style>
html,body{margin:0;padding:0;width:100%;height:100%;background:#000;color:#fff;font-family:"Courier New",monospace;overflow:hidden;}
#boot,#intro,#xpDesktop,#staticOverlay{position:absolute;top:0;left:0;width:100%;height:100%;}
#boot{background:#000;color:#0f0;display:flex;align-items:center;justify-content:center;font-size:20px;}
#intro{background:#000;display:none;flex-direction:column;align-items:center;justify-content:center;font-size:18px;padding:30px;text-align:center;}
#intro p{max-width:700px;}
#xpDesktop{background:url('https://i.imgur.com/6cJ2NUp.jpeg') center/cover no-repeat;display:none;position:relative;}
#taskbar{position:absolute;bottom:0;left:0;width:100%;height:40px;background:linear-gradient(#2a66b0,#1d4f94);display:flex;align-items:center;padding:0 10px;box-sizing:border-box;}
#startBtn{background:#1a5cb8;border:1px solid #0c3e87;color:#fff;padding:5px 15px;font-weight:bold;border-radius:3px;cursor:pointer;}
#clock{margin-left:auto;font-size:14px;}
.icon{position:absolute;width:60px;text-align:center;color:#fff;cursor:pointer;text-shadow:1px 1px 3px #000;}
.icon img{width:48px;height:48px;}
.window{position:absolute;width:420px;background:#ece9d8;border:2px solid #003399;box-shadow:3px 3px 10px rgba(0,0,0,.6);border-radius:4px;display:none;color:#000;}
.win-header{background:linear-gradient(#245edc,#1742a0);color:#fff;padding:3px 6px;cursor:move;font-size:13px;display:flex;justify-content:space-between;align-items:center;}
.win-content{background:#fff;padding:10px;font-family:Consolas,monospace;color:#111;font-size:13px;max-height:300px;overflow-y:auto;}
.closeBtn{cursor:pointer;font-weight:bold;}
#staticOverlay{display:none;background:#000 url('https://i.imgur.com/ayk9B7P.gif') center/cover no-repeat;opacity:0;transition:opacity 2s;}
</style>
</head>
<body>

<!-- BOOT -->
<div id="boot">Initializing System...<br>Loading Threshold OS 1.3...</div>

<!-- INTRO / INVESTIGATOR LOG -->
<div id="intro">
<h2>Investigator’s Log</h2>
<p><strong>Day 1 — Scene Analysis</strong></p>
<p>The apartment is too quiet.<br>
Clara lies on her back, eyes open, arms neatly to her sides. No sign of resistance.<br>
The only light is the dim glow from her computer monitor.<br>
A sticky note whispers the same promise repeated in her online messages:<br>
<em>“Home before dawn.”</em></p>
<p>The system clock reads <strong>02:13 AM.</strong></p>
<p>Click below to begin forensic analysis.</p>
<button id="beginBtn">Access System</button>
</div>

<!-- XP DESKTOP -->
<div id="xpDesktop">
<div class="icon" id="recycle" style="top:60px;left:40px;">
<img src="https://cdn-icons-png.flaticon.com/512/565/565515.png"><div>Recycle Bin</div>
</div>
<div class="icon" id="docs" style="top:60px;left:130px;">
<img src="https://cdn-icons-png.flaticon.com/512/337/337946.png"><div>My Documents</div>
</div>
<div class="icon" id="mail" style="top:60px;left:220px;">
<img src="https://cdn-icons-png.flaticon.com/512/561/561127.png"><div>Mail</div>
</div>
<div class="icon" id="usb" style="top:60px;left:310px;">
<img src="https://cdn-icons-png.flaticon.com/512/179/179598.png"><div>USB</div>
</div>

<div id="taskbar"><div id="startBtn">Start</div><div id="clock"></div></div>
</div>

<div id="staticOverlay"></div>

<audio id="ambient" src="ambient.mp3" loop></audio>
<audio id="bell" src="bell.mp3"></audio>
<audio id="staticS" src="static.mp3"></audio>

<script>
// ---------- BOOT + INTRO ----------
const boot=document.getElementById('boot');
const intro=document.getElementById('intro');
const xpDesktop=document.getElementById('xpDesktop');
setTimeout(()=>{boot.style.display='none';intro.style.display='flex';},3000);
document.getElementById('beginBtn').onclick=()=>{
intro.style.display='none';
xpDesktop.style.display='block';
ambient.volume=0.2;ambient.play();
};

// ---------- CLOCK ----------
const clock=document.getElementById('clock');
function tick(){
const d=new Date();
clock.textContent=d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
}
setInterval(tick,1000);tick();

// ---------- GENERIC WINDOW ----------
function openWindow(id,title,content){
let win=document.getElementById('win-'+id);
if(!win){
win=document.createElement('div');win.className='window';win.id='win-'+id;
win.innerHTML=`<div class="win-header">${title}<span class="closeBtn">×</span></div><div class="win-content">${content}</div>`;
xpDesktop.appendChild(win);
const header=win.querySelector('.win-header');const close=win.querySelector('.closeBtn');
makeDraggable(header,win);
close.onclick=()=>win.style.display='none';
centerWindow(win);
}
win.style.display='block';win.style.zIndex=++zTop;
}
function centerWindow(win){win.style.left=(window.innerWidth/2-210)+'px';win.style.top=(window.innerHeight/2-150)+'px';}

// ---------- ICONS ----------
document.getElementById('recycle').onclick=()=>openWindow('truth','_truth.docx',
`<p><em>Mother faces the wall.</em></p>
<p style="color:#fff;background:#000;">25 15 21 18 12 25 9 14 7 …</p>
<p><strong>You’re lying…</strong></p>`);

document.getElementById('docs').onclick=()=>{
openWindow('doors','C:\\Users\\Clara\\Documents\\HigherHeaven',
`<p>Door<br>↳ Door<br>↳ Door<br>↳ Door<br>↳ Bell.mp3</p>
<p><em>Play Bell.mp3 → “She has her back to you.”</em></p>`);
bell.play();flicker();
};

document.getElementById('startBtn').onclick=()=>openWindow('log','session0213.log',
`[02:09:00] Prepare<br>[02:10:00] Face the wall<br>[02:11:00] Lie down<br>[02:12:00] Cry for her<br>[02:13:00] Door opens<br><br><span>lying… mother… bell…</span>`);

document.getElementById('mail').onclick=()=>openWindow('mail','Draft: Permission to Open',
`Subject: Permission to Open<br>Body:<br>Passphrase: sevenfold noon.<br>Wayward waits. The door listens.<br><br><em>Attachment decoded → “A bell rings.”</em>`);

document.getElementById('usb').onclick=()=>{
openWindow('usb','USB:_Rehearsal',
`<p>02:06 — “You’re lying.”<br>
02:07 — “On your back.”<br>
02:08 — “Crying out.”<br>
02:09 — “For your mother.”<br>
02:10 — “She is standing.”<br>
02:11 — “Facing the wall.”<br>
02:12 — “She has her back to you.”</p>
<div id="finalClue" style="display:none;margin-top:10px;border-top:1px solid #ccc;padding-top:10px;">
0213.txt:<br>“A bell rings.<br>Your mother turns to face you.<br>
She is silent, but her mouth is open wide.<br>In her mouth is a door.”</div>`);
setTimeout(()=>{
const clue=document.getElementById('finalClue');
if(!clue)return;
clue.style.display='block';
staticOverlay.style.display='block';
staticOverlay.style.opacity='0.2';
staticS.volume=0.4;staticS.play();
setTimeout(()=>fadeToStaticEnd(),8000);
},10000);
};

// ---------- EFFECTS ----------
function flicker(){
xpDesktop.style.filter='brightness(0.6)';
setTimeout(()=>xpDesktop.style.filter='brightness(1)',300);
}
function fadeToStaticEnd(){
let op=0.2;
const fade=setInterval(()=>{
op+=0.05;
staticOverlay.style.opacity=op;
if(op>=1){clearInterval(fade);ambient.pause();bell.pause();staticS.pause();showFinalLog();}
},400);
}
function showFinalLog(){
staticOverlay.style.display='none';
xpDesktop.innerHTML='';
openWindow('doorlog','door_open_0213.log','She is silent, but her mouth is open wide.');
const win=document.getElementById('win-doorlog');centerWindow(win);win.style.zIndex='9999';
}

// ---------- DRAG ----------
let zTop=500;
function makeDraggable(header,win){
let offX,offY,down=false;
header.onmousedown=e=>{down=true;offX=e.clientX-win.offsetLeft;offY=e.clientY-win.offsetTop;win.style.zIndex=++zTop;};
document.onmouseup=()=>down=false;
document.onmousemove=e=>{if(!down)return;win.style.left=(e.clientX-offX)+'px';win.style.top=(e.clientY-offY)+'px';};
}
</script>
</body>
</html>
