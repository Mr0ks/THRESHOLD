<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>THRESHOLD</title>
<style>
  :root { --boot-bg:#000; --boot-fg:#0f0; }
  * { box-sizing:border-box; margin:0; padding:0; }
  html,body { height:100%; font-family:Tahoma, sans-serif; overflow:hidden; }

  .bootScreen{background:#000; color:#0f0; padding:20px; font-family:Consolas,monospace; font-size:14px;}
  .progressLine{margin-top:1em; color:#0f0;}
  .xpDesktop{position:fixed; inset:0; background:url('https://upload.wikimedia.org/wikipedia/en/2/24/Bliss_%28Windows_XP%29.png') center/cover no-repeat; overflow:hidden;}
  .icon{position:absolute;width:90px;text-align:center;font-size:13px;color:white;text-shadow:1px 1px 2px black;cursor:pointer;}
  .icon img{width:48px;height:48px;display:block;margin:0 auto 5px;}
  .taskbar{position:fixed;bottom:0;left:0;right:0;height:38px;background:linear-gradient(to bottom,#1C52C6,#163A8D);display:flex;align-items:center;padding:0 10px;}
  .startBtn{background:linear-gradient(to bottom,#3DB13D,#2B7C2B);color:white;border:none;border-radius:3px;padding:4px 10px;font-weight:bold;font-size:14px;cursor:pointer;display:flex;align-items:center;gap:4px;}
  .clock{margin-left:auto;font-size:13px;color:white;}

  .window{position:absolute;width:480px;height:320px;background:#ECE9D8;border:2px solid #000;box-shadow:4px 4px 8px rgba(0,0,0,.5);display:none;flex-direction:column;}
  .windowHeader{background:linear-gradient(to bottom,#2B7CDA,#1851A3);color:white;padding:4px 8px;font-weight:bold;cursor:move;display:flex;justify-content:space-between;align-items:center;}
  .windowContent{flex:1;background:white;color:black;padding:10px;overflow:auto;}
  .minBtn{background:#d4d0c8;border:1px solid #808080;width:18px;height:18px;text-align:center;line-height:15px;cursor:pointer;}
  .errorBox{display:flex;align-items:center;gap:10px;}
  .errorIcon{width:32px;height:32px;}
  .okBtn{margin-top:15px;padding:4px 12px;background:#d4d0c8;border:1px solid #808080;cursor:pointer;}
</style>
</head>
<body>

<div id="boot" class="bootScreen">
  <div>[BOOT] Initializing Windows XP...</div>
  <div>[BOOT] Checking hardware... OK</div>
  <div>[BOOT] Loading kernel... OK</div>
  <div>[BOOT] Starting services... OK</div>
  <div>[BOOT] Launching graphical interface...</div>
  <div class="progressLine" id="progressLine">[                    ] 0%</div>
</div>

<audio id="xpSound" src="https://archive.org/download/windows-xp-startup_202403/WindowsXP_Startup.mp3" preload="auto"></audio>

<script>
// --- BOOT ---
const progress=document.getElementById('progressLine');
let pct=0,total=20;
const t=setInterval(()=>{
  pct=Math.min(100,pct+Math.floor(Math.random()*8)+5);
  const filled=Math.round((pct/100)*total);
  progress.textContent="["+ "#".repeat(filled).padEnd(total," ")+"] "+pct+"%";
  if(pct>=100){clearInterval(t);setTimeout(loadXP,600);}
},120);

// --- DESKTOP ---
function loadXP(){
  document.body.innerHTML=`
  <div class="xpDesktop" id="xpDesk">
    <div class="icon" id="myComputer" style="top:40px;left:40px;">
      <img src="https://icons.iconarchive.com/icons/tpdkdesign.net/refresh-cl/256/My-Computer-icon.png"><div>My Computer</div>
    </div>
    <div class="icon" id="myDocs" style="top:130px;left:40px;">
      <img src="https://icons.iconarchive.com/icons/tpdkdesign.net/refresh-cl/256/My-Documents-icon.png"><div>My Documents</div>
    </div>
    <div class="icon" id="ieIcon" style="top:220px;left:40px;">
      <img src="https://icons.iconarchive.com/icons/tpdkdesign.net/refresh-cl/256/Internet-Explorer-icon.png"><div>Internet Explorer</div>
    </div>
    <div class="icon" id="netIcon" style="top:310px;left:40px;">
      <img src="https://icons.iconarchive.com/icons/tpdkdesign.net/refresh-cl/256/My-Network-Places-icon.png"><div>Network Places</div>
    </div>
    <div class="icon" id="mailIcon" style="top:400px;left:40px;">
      <img src="https://icons.iconarchive.com/icons/dtafalonso/win-10x/256/Mail-icon.png"><div>Mail</div>
    </div>
    <div class="icon" id="chromeIcon" style="top:490px;left:40px;">
      <img src="https://icons.iconarchive.com/icons/google/chrome/256/Google-Chrome-icon.png"><div>Chrome</div>
    </div>
    <div class="icon" id="binIcon" style="top:580px;left:40px;">
      <img src="https://icons.iconarchive.com/icons/tpdkdesign.net/refresh-cl/256/Recycle-Bin-Full-icon.png"><div>Recycle Bin</div>
    </div>
    <div class="taskbar"><button class="startBtn">ðŸªŸ Start</button><div class="clock" id="xpClock"></div></div>
  </div>
  <div class="window" id="mailWin"><div class="windowHeader">Mail<div class="minBtn" data-min="mailWin">_</div></div><div class="windowContent">You have 1 new message.<br><br><b>From:</b> Clara<br><b>Subject:</b> Donâ€™t open the door.</div></div>
  <div class="window" id="chromeWin"><div class="windowHeader">Chrome<div class="minBtn" data-min="chromeWin">_</div></div><div class="windowContent"><b>Clara's Secret Site</b><br><br>Access denied. Connection terminated unexpectedly.</div></div>
  <div class="window" id="binWin"><div class="windowHeader">Recycle Bin<div class="minBtn" data-min="binWin">_</div></div><div class="windowContent"><b>Deleted Files</b><ul><li>clara_laptop_log.txt</li><li>higherheaven_members.csv</li><li>door_key.jpg</li></ul></div></div>`;
  
  document.getElementById('xpSound').play().catch(()=>{});
  const xpClock=document.getElementById('xpClock');
  setInterval(()=>{xpClock.textContent=new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})},1000);

  // Openers
  const opens={mailIcon:'mailWin',chromeIcon:'chromeWin',binIcon:'binWin'};
  for(let id in opens){
    document.getElementById(id).onclick=()=>openWindow(opens[id]);
  }

  // Corrupted apps
  ['myComputer','myDocs','ieIcon','netIcon'].forEach(id=>{
    document.getElementById(id).onclick=()=>spawnError("Corrupted Application","This application is corrupted and cannot be opened.");
  });

  makeDraggable();
}

// --- Window functions ---
function openWindow(id){
  const w=document.getElementById(id);
  if(!w)return;
  w.style.display='flex';
  w.style.top=Math.random()*200+100+'px';
  w.style.left=Math.random()*300+200+'px';
}

function makeDraggable(){
  document.querySelectorAll('.window').forEach(win=>{
    const header=win.querySelector('.windowHeader');
    let offX=0,offY=0,isDown=false;
    header.addEventListener('mousedown',e=>{
      isDown=true;offX=e.clientX-win.offsetLeft;offY=e.clientY-win.offsetTop;
      document.body.style.userSelect='none';
    });
    document.addEventListener('mouseup',()=>{isDown=false;document.body.style.userSelect='auto';});
    document.addEventListener('mousemove',e=>{
      if(!isDown)return;
      win.style.left=(e.clientX-offX)+'px';
      win.style.top=(e.clientY-offY)+'px';
    });
  });
  document.querySelectorAll('.minBtn').forEach(btn=>{
    btn.onclick=()=>{document.getElementById(btn.dataset.min).style.display='none';};
  });
}

// --- Error popup ---
function spawnError(title,msg){
  const id='err'+Math.random().toString(36).slice(2);
  const box=document.createElement('div');
  box.className='window';
  box.id=id;
  box.innerHTML=`<div class="windowHeader">${title}<div class="minBtn" data-min="${id}">_</div></div>
  <div class="windowContent">
  <div class="errorBox"><img class="errorIcon" src="https://icons.iconarchive.com/icons/oxygen-icons.org/oxygen/256/Status-dialog-error-icon.png"><div>${msg}</div></div>
  <button class="okBtn" onclick="document.getElementById('${id}').remove()">OK</button></div>`;
  document.body.appendChild(box);
  box.style.display='flex';
  box.style.top=Math.random()*300+50+'px';
  box.style.left=Math.random()*400+100+'px';
  makeDraggable();
}
</script>
</body>
</html>
