<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>email client</title>
<style>
  :root{
    --bg:#e9edf2; --panel:#fff; --border:#c7ccd1; --border-dk:#b3b8bd;
    --ink:#222; --muted:#5a6b7a; --accent:#2a6dce;
    --row-hover:#f3f6f9; --row-select:#cfe8ff;
    --boot-bg:#000; --boot-fg:#fff; --intro-red:#d20000;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;font:13px/1.45 system-ui,-apple-system,"Segoe UI",Arial,sans-serif;color:var(--ink);background:var(--bg)}

  /* ---------- BOOT ---------- */
  .boot, .boot2, .progressStage, .intro {
    position:fixed; inset:0; background:var(--boot-bg); color:var(--boot-fg);
  }
  .boot, .boot2, .progressStage {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    padding:14px; overflow:auto; line-height:1.2;
  }
  .bootLine{white-space:pre; font-size:14px; margin-bottom:2px}
  .prompt {margin-top:8px}
  .kbd {display:inline-block; border:1px solid #777; padding:0 6px; border-radius:3px; font-weight:700}
  .hidden{display:none !important;}

  /* Progress bar line like: [====      ] 45% */
  .progressLine{white-space:pre; font-size:14px}
  .progressBar {
    display:inline-block; width:24ch; border:1px solid #777; padding:0 0.5ch; letter-spacing:0.1ch;
  }

  /* ---------- INTRO ---------- */
  .intro {display:flex; align-items:center; justify-content:center; background:#000}
  .title {
    color:var(--intro-red); font-weight:900; text-transform:uppercase; text-align:center;
    line-height:0.9; user-select:none;
    /* Massive responsiveness */
    font-size: clamp(56px, 16vw, 220px);
  }
  .subtitle {
    color:#bbb; margin-top:20px; font:14px/1.3 ui-monospace,monospace; letter-spacing:.08em;
    text-align:center;
  }
  .fadeOut {animation: fadeOut 1s ease forwards}
  @keyframes fadeOut { to { opacity:0; visibility:hidden } }

  /* ---------- APP (MAIL) ---------- */
  .app{display:none; grid-template-columns:220px 1fr; height:100%; border-top:1px solid var(--border)}
  aside{border-right:1px solid var(--border-dk); background:var(--panel); display:flex; flex-direction:column}
  header{padding:10px; font-weight:600; border-bottom:1px solid var(--border)}
  .search{padding:8px 10px; border-bottom:1px solid var(--border)}
  .search input{width:100%; padding:6px 8px; border:1px solid var(--border-dk); border-radius:3px}
  .folders{flex:1; overflow:auto; padding:6px}
  .folder{display:flex; align-items:center; gap:6px; padding:6px 8px; border-radius:4px; cursor:pointer}
  .folder:hover{background:#f6f8fa}
  .folder.active{background:#eaf2ff}
  .folder small{color:var(--muted); margin-left:auto}
  .status{padding:6px 8px; font-size:12px; border-top:1px solid var(--border); background:#f7f9fb; color:#3c4a57}

  main{display:flex; flex-direction:column; background:var(--panel)}
  .toolbar{display:flex; justify-content:flex-end; gap:6px; padding:6px 10px; border-bottom:1px solid var(--border); background:#f7f9fb}
  .btn{background:#eaf0f7; border:1px solid var(--border-dk); border-radius:3px; padding:4px 8px; cursor:pointer}
  .btn:hover{background:#dde7f5}

  .columns{display:grid; grid-template-columns:180px 1fr 100px; font-weight:600; border-bottom:1px solid var(--border); background:#f5f8fc}
  .col{padding:6px 8px; border-right:1px solid var(--border)}
  .col:last-child{border-right:none; text-align:right}

  .list{overflow:auto; border-bottom:1px solid var(--border); flex:1}
  .row{display:grid; grid-template-columns:180px 1fr 100px; align-items:center; cursor:pointer}
  .cell{padding:6px 8px; border-right:1px solid var(--border)}
  .cell:last-child{border-right:none; text-align:right; color:var(--muted)}
  .row:hover{background:var(--row-hover)}
  .row.selected{background:var(--row-select)}

  .readerHead{padding:10px; font-weight:600; border-bottom:1px solid var(--border); background:#fafcfe}
  article{flex:1; overflow:auto; padding:12px}
  article .meta{color:var(--muted); margin-bottom:8px}

  /* Small screens: stack columns */
  @media (max-width: 760px){
    .app{grid-template-columns: 1fr}
    aside{position:sticky; top:0; z-index:2}
  }
</style>
</head>
<body>

<!-- Boot Stage 1: scrolling logs -->
<div id="boot" class="boot" role="region" aria-label="System boot log">
  <!-- lines injected by JS -->
</div>

<!-- Boot Stage 2: single extra line on black (no fade) -->
<div id="boot2" class="boot2 hidden">
  <div class="bootLine">:: Preparing userlandâ€¦</div>
</div>

<!-- Boot Stage 3: terminal-style progress bar -->
<div id="progressStage" class="progressStage hidden">
  <div class="bootLine">:: Starting The Door environment</div>
  <div class="bootLine">:: Checking services: network OK, display OK, input OK</div>
  <br>
  <div id="pLine" class="progressLine">[                    ] 0%</div>
</div>

<!-- Intro: big red THE DOOR -->
<div id="intro" class="intro hidden">
  <div>
    <div class="title">THE DOOR</div>
    <div class="subtitle">Based on Wayward and other movies</div>
  </div>
</div>

<!-- App (Mail) -->
<div class="app" id="app">
  <aside>
    <header>Mail</header>
    <div class="search"><input id="q" type="search" placeholder="Search mail"></div>
    <div class="folders">
      <div class="folder active">ðŸ“¥ Inbox <small id="unread">0</small></div>
    </div>
    <div class="status" id="status">Ready</div>
  </aside>

  <main>
    <div class="toolbar">
      <button id="deleteBtn" class="btn">Delete Selected</button>
    </div>
    <div class="columns">
      <div class="col">From</div>
      <div class="col">Subject</div>
      <div class="col">Date</div>
    </div>
    <div id="list" class="list"></div>
    <div id="readerHead" class="readerHead">No message selected</div>
    <article id="reader">
      <p class="meta">Select a message to preview.</p>
    </article>
  </main>
</div>

<script>
/* =========================
   BOOT: Stage 1 (logs)
   ========================= */
const bootEl = document.getElementById('boot');
const boot2  = document.getElementById('boot2');
const progressStage = document.getElementById('progressStage');
const intro  = document.getElementById('intro');
const app    = document.getElementById('app');

const bootLines = [
  "[    0.000000] Linux version 6.8.1-arch (arch@build) (gcc (GCC) 13.2.1) #1 SMP",
  "[    0.003214] Command line: BOOT_IMAGE=/vmlinuz-linux root=UUID=xxxx rw loglevel=3 quiet",
  "[    0.121007] x86/fpu: Supporting XSAVE feature 0x001: 'x87 floating point registers'",
  "[    1.287669] core: CPUID marked event: 'cpu cycles' unavailable",
  "[    1.287674] core: CPUID marked event: 'instructions' unavailable",
  "[    1.287677] core: CPUID marked event: 'bus cycles' unavailable",
  "[    1.287679] core: CPUID marked event: 'cache references' unavailable",
  "[    1.287681] core: CPUID marked event: 'cache misses' unavailable",
  "[    1.287683] core: CPUID marked event: 'branch instructions' unavailable",
  "[    1.287686] core: CPUID marked event: 'branch misses' unavailable",
  "Starting systemd-udevd version 256.4-1-arch",
  ":: running early hook [udev]",
  ":: running hook [udev]",
  ":: Triggering uevents...",
  "[    2.104220] input: AT Translated Set 2 keyboard as /devices/platform/i8042/serio0/input/input3",
  "[    2.204220] random: crng init done",
  "",
  "Press ENTER to continue"
];

let idx = 0;
function appendBootLine() {
  if (idx >= bootLines.length) return;
  const line = document.createElement('div');
  line.className = 'bootLine';
  line.textContent = bootLines[idx++];
  bootEl.appendChild(line);
  bootEl.scrollTop = bootEl.scrollHeight;
  if (idx < bootLines.length) {
    const delay = (bootLines[idx-1] === "") ? 200 : 80 + Math.random()*70;
    setTimeout(appendBootLine, delay);
  }
}
appendBootLine();

/* ENTER to move to Stage 2 -> Stage 3 -> INTRO -> APP */
document.addEventListener('keydown', (e)=>{
  if (e.key === 'Enter' && !bootEl.classList.contains('hidden')) {
    // Clear to black, show extra boot line (no fade)
    bootEl.classList.add('hidden');
    boot2.classList.remove('hidden');

    // After a short beat, go to progress bar
    setTimeout(()=>{
      boot2.classList.add('hidden');
      progressStage.classList.remove('hidden');
      startProgress();
    }, 650);
  }
});

/* =========================
   BOOT: Stage 3 (progress)
   ========================= */
const pLine = document.getElementById('pLine');

function startProgress() {
  let pct = 0;
  const totalSlots = 20; // inside [####################]
  const tick = setInterval(()=>{
    pct = Math.min(100, pct + Math.floor(Math.random()*8)+2);
    const filled = Math.round((pct/100)*totalSlots);
    const bar = "[" + "#".repeat(filled).padEnd(totalSlots, " ") + "] ";
    pLine.textContent = bar + String(pct).padStart(2," ") + "%";

    if (pct >= 100) {
      clearInterval(tick);
      setTimeout(()=>{
        progressStage.classList.add('hidden');
        showIntro();
      }, 350);
    }
  }, 120); // total ~3â€“5s depending on randomness
}

/* =========================
   INTRO (fade out)
   ========================= */
function showIntro(){
  intro.classList.remove('hidden');
  // After 2.2s, fade out, then show app
  setTimeout(()=>{
    intro.classList.add('fadeOut');
    setTimeout(()=>{
      intro.classList.add('hidden');
      app.style.display = 'grid';
    }, 1000);
  }, 2200);
}

/* =========================
   MAIL APP (simple + delete)
   ========================= */
const listEl = document.getElementById('list');
const reader = document.getElementById('reader');
const readerHead = document.getElementById('readerHead');
const unreadEl = document.getElementById('unread');
const statusEl = document.getElementById('status');
const q = document.getElementById('q');
const deleteBtn = document.getElementById('deleteBtn');

let messages = [
  {id:'1',from:'HR â€“ Alice',subject:'Welcome to the facility',preview:'Please read carefullyâ€¦',date:'Oct 16',body:'<h2>Welcome</h2><p>Please complete all tasks assigned to you.</p>',unread:true},
  {id:'2',from:'Ops â€“ Dana',subject:'Access policy updated',preview:'Your keycardâ€¦',date:'Oct 15',body:'<h2>Access Update</h2><p>Your keycard access has been updated.</p>',unread:true},
  {id:'3',from:'Support',subject:'Ticket #39210 resolved',preview:'We have fixed your issueâ€¦',date:'Oct 14',body:'<h2>Ticket Closed</h2><p>Issue resolved. Reply if it reoccurs.</p>',unread:false}
];
let selectedId = null;

function rowTemplate(m){
  return `<div class="row ${m.id===selectedId?'selected':''}" data-id="${m.id}">
    <div class="cell">${m.from}</div>
    <div class="cell">${m.subject}</div>
    <div class="cell">${m.date}</div>
  </div>`;
}
function renderList(filter=''){
  const f = filter.trim().toLowerCase();
  const filtered = messages.filter(m => (m.from+' '+m.subject+' '+m.preview).toLowerCase().includes(f));
  listEl.innerHTML = filtered.map(rowTemplate).join('');
  unreadEl.textContent = messages.filter(m=>m.unread).length;
  statusEl.textContent = `${filtered.length} message${filtered.length===1?'':'s'}`;
  listEl.querySelectorAll('.row').forEach(r => r.onclick = () => openMessage(r.dataset.id));
}
function openMessage(id){
  const m = messages.find(x=>x.id===id);
  if(!m) return;
  selectedId = id;
  m.unread = false;
  readerHead.textContent = `${m.from} â€” ${m.subject}`;
  reader.innerHTML = `<p class="meta">${m.date}</p>` + m.body;
  renderList(q.value);
}
deleteBtn.addEventListener('click', ()=>{
  if(!selectedId){ alert('No email selected'); return; }
  messages = messages.filter(m => m.id !== selectedId);
  selectedId = null;
  readerHead.textContent = 'No message selected';
  reader.innerHTML = '<p class="meta">Select a message to preview.</p>';
  renderList(q.value);
});
q.addEventListener('input', e => renderList(e.target.value));
renderList();
</script>
</body>
</html>
