<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>THE DOOR</title>
<style>
  :root{
    --boot-bg:#000; --boot-fg:#fff; --intro-red:#d20000;
    --bg:#e9edf2; --panel:#fff; --border:#c7ccd1; --border-dk:#b3b8bd;
    --ink:#222; --muted:#5a6b7a;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;background:#000;font:13px/1.45 system-ui,-apple-system,"Segoe UI",Arial,sans-serif;color:var(--ink);overflow:hidden}

  /* ---------- START SCREEN ---------- */
  .startScreen {
    position:fixed; inset:0;
    display:flex; align-items:center; justify-content:center;
    background:#000; color:#fff; cursor:pointer;
    font-size:clamp(20px,3vw,28px); user-select:none;
    opacity:1; transition:opacity 1.5s ease;
    z-index:20;
  }
  .fadeOut{opacity:0!important;}

  /* ---------- INTRO ---------- */
  .intro {
    position:fixed; inset:0;
    display:flex; flex-direction:column;
    align-items:center; justify-content:center;
    background:#000; text-align:center; z-index:10;
  }
  .introSmall {
    color:#fff;
    font-weight:600;
    text-transform:uppercase;
    opacity:0; margin:10px 0;
    font-size:clamp(18px,3vw,26px);
    font-family:ui-monospace,monospace;
    transition:opacity 2s ease;
  }
  .title {
    position:absolute;
    top:50%; left:50%;
    transform:translate(-50%,-50%);
    color:var(--intro-red);
    font-weight:900;
    text-transform:uppercase;
    white-space:nowrap; /* Keeps "THE DOOR" on one line */
    text-align:center;
    line-height:1;
    user-select:none;
    opacity:0;
    font-size:clamp(56px,16vw,220px);
    transition:opacity 2s ease;
  }
  .fadeIn{opacity:1!important;}
  .fadeOutSmooth{animation:fadeOutSmooth 2s ease forwards;}
  @keyframes fadeOutSmooth{to{opacity:0;}}
  
  /* ---------- BOOT ---------- */
  .boot, .boot2, .progressStage {
    position:fixed; inset:0;
    background:var(--boot-bg); color:var(--boot-fg);
    font-family:ui-monospace, Menlo, Consolas, monospace;
    padding:14px; overflow:auto; line-height:1.2;
    display:none;
  }
  .bootLine{white-space:pre; font-size:14px; margin-bottom:2px}
  .progressLine{white-space:pre; font-size:14px}

  /* ---------- APP ---------- */
  .app{display:none; place-items:center; height:100%; background:#fff; font-size:24px; font-weight:600;}
</style>
</head>
<body>

<!-- Start screen -->
<div id="startScreen" class="startScreen">Click anywhere to begin...</div>

<!-- INTRO -->
<div id="intro" class="intro" style="display:none;">
  <div>
    <div class="introSmall" id="line1">This game is protected by an MIT license.</div>
    <div class="introSmall" id="line2">This game is based on Wayward and other movies.</div>
    <div class="introSmall" id="line3">Contains flashing lights, loud sounds, and psychological horror.</div>
    <div class="introSmall" id="line4">Loading assets...</div>
    <div class="introSmall" id="line5">Verifying integrity...</div>
    <div class="introSmall" id="line6">Initializing environment...</div>
    <div class="introSmall" id="line7">All systems nominal.</div>
    <div class="introSmall" id="line8">Presenting...</div>
  </div>
  <div class="title" id="doorTitle">THE DOOR</div>
</div>

<!-- Boot -->
<div id="boot" class="boot"></div>
<div id="boot2" class="boot2"><div class="bootLine">:: Preparing userland…</div></div>
<div id="progressStage" class="progressStage">
  <div class="bootLine">:: Starting The Door environment</div>
  <div class="bootLine">:: Checking services: network OK, display OK, input OK</div><br>
  <div id="pLine" class="progressLine">[                    ] 0%</div>
</div>

<!-- App -->
<div id="app" class="app">[ Mail UI Loaded ]</div>

<script>
const startScreen=document.getElementById('startScreen');
const intro=document.getElementById('intro');
const bootEl=document.getElementById('boot');
const boot2=document.getElementById('boot2');
const progressStage=document.getElementById('progressStage');
const app=document.getElementById('app');
const pLine=document.getElementById('pLine');

startScreen.addEventListener('click',()=>{
  startScreen.classList.add('fadeOut');
  setTimeout(()=>{
    startScreen.style.display='none';
    startIntro();
  },1500);
});

/* ===== INTRO FIRST ===== */
function startIntro(){
  intro.style.display='flex';
  const door=document.getElementById('doorTitle');
  const audio=new Audio('sounds/intro.mp3');
  audio.volume=1; audio.play();

  const lines=[...document.querySelectorAll('.introSmall')];
  let delay=1000;
  lines.forEach((line)=>{
    setTimeout(()=>line.classList.add('fadeIn'),delay);
    setTimeout(()=>line.classList.add('fadeOutSmooth'),delay+3500);
    delay+=4000;
  });

  // THE DOOR fade in and out centered
  setTimeout(()=>door.classList.add('fadeIn'),29000);
  setTimeout(()=>door.classList.add('fadeOutSmooth'),36000);

  // End of intro → fade music → boot
  setTimeout(()=>{
    const fade=setInterval(()=>{
      if(audio.volume>0.05){audio.volume-=0.05;}else{clearInterval(fade);audio.pause();}
    },200);
    setTimeout(()=>{
      intro.style.display='none';
      startBoot();
    },2000);
  },40000);
}

/* ===== BOOT AFTER INTRO ===== */
const bootLines=[
 "[    0.000000] Linux version 6.8.1-arch",
 "[    0.002314] Booting system modules...",
 ":: Mounting /dev/sda1 to /mnt/root",
 ":: Starting udevd...",
 ":: Network manager started",
 ":: Boot complete — Press ENTER to continue"
];

function startBoot(){
  bootEl.style.display='block';
  let i=0;
  function appendBootLine(){
    if(i>=bootLines.length)return;
    const l=document.createElement('div');l.className='bootLine';l.textContent=bootLines[i++];
    bootEl.appendChild(l);bootEl.scrollTop=bootEl.scrollHeight;
    if(i<bootLines.length)setTimeout(appendBootLine,100);
  }
  appendBootLine();

  document.addEventListener('keydown',e=>{
    if(e.key==='Enter'&&bootEl.style.display==='block'){
      bootEl.style.display='none';
      boot2.style.display='block';
      setTimeout(()=>{
        boot2.style.display='none';
        progressStage.style.display='block';
        startProgress();
      },800);
    }
  });
}

function startProgress(){
  let pct=0;const total=20;
  const t=setInterval(()=>{
    pct=Math.min(100,pct+Math.floor(Math.random()*8)+5);
    const filled=Math.round((pct/100)*total);
    const bar="["+ "#".repeat(filled).padEnd(total," ")+"] "+String(pct).padStart(2," ")+"%";
    pLine.textContent=bar;
    if(pct>=100){clearInterval(t);setTimeout(()=>{progressStage.style.display='none';app.style.display='grid';},300);}
  },120);
}
</script>
</body>
</html>
